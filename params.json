{"note":"Don't delete this file! It's used internally to help with page regeneration.","google":"","tagline":"Planificación de caminos para robots móviles en lenguaje M.","body":"﻿# Planificación de caminos\r\n﻿\r\n﻿Realizado por [Manuel](https://github.com/recoletosmb) y [Miguel](https://github.com/Miguelos). [![endorse](http://api.coderwall.com/miguelos/endorsecount.png)](http://coderwall.com/miguelos)\r\n\r\n---\r\n\r\n### Descripción\r\n\r\nPlanificación del camino de un robot móvil entre dos puntos pasando por un punto intermedio\r\n\r\n### Planteamiento \r\n\r\nEl programa calcula los coeficientes de los polinomios para que pasen por un punto inicial (p0), despegue (p1), intermedio (p2), asentamiento (p3) y final (p4). \r\n\r\nTramos del camino:\r\n* De p0 a p1\r\n* De p1 a p3 (pasando por el punto intermedio p2, situado a mitad del tiempo que durará el recorrido por este tramo)\r\n* De p3 a p4\r\n\r\n![mapa](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image23.png)\r\n\r\nPara el punto inicial y final tenemos posición velocidad y aceleración. Para p1 y p3 tenemos continuidad, posición, velocidad y aceleración. El punto p2 es un punto extra el cual queda a mitad del recorrido del 2º tramo. Para el punto 2 tenemos sólo su posición.\r\n\r\nTenemos 3 segmentos = 3 (3+1) + 3 = 15 coeficientes. Se calcula la trayectoria con tres polinomios de grado 4 (4-4-4).\r\n\r\nPolinomios: \r\n* ![h1(t) = a14t^4 + a13t^3 + a12t^2 + a11t+a10](http://latex.codecogs.com/gif.latex?h1(t\\)=a_{14}*t_{0}^{4}+a_{13}*t_{0}^{3}+a_{12}*t_{0}^{2}+a_{11}*t_{0}+a_{10})\r\n* ![h2(t) = a14t^4 + a13t^3 + a12t^2 + a11t+a10](http://latex.codecogs.com/gif.latex?h2(t\\)=a_{24}*t_{0}^{4}+a_{23}*t_{0}^{3}+a_{22}*t_{0}^{2}+a_{21}*t_{0}+a_{20})\r\n* ![h3(t) = a14t^4 + a13t^3 + a12t^2 + a11t+a10](http://latex.codecogs.com/gif.latex?h3(t\\)=a_{34}*t_{0}^{4}+a_{33}*t_{0}^{3}+a_{32}*t_{0}^{2}+a_{31}*t_{0}+a_{30})\r\n\r\nPunto inicial (p0)\r\n* Posición: ![p0 = a14t0^4 + a13t0^3 + a12t0^2 + a11t0 + a10](http://latex.codecogs.com/gif.latex?p0=a_{14}*t_{0}^{4}+a_{13}*t_{0}^{3}+a_{12}*t_{0}^{2}+a_{11}*t_{0}+a_{10})\r\n* Velocidad: ![v0 = 4*a14t0^3 + 3*a13t0^2 + 2*a12t0 + a11](http://latex.codecogs.com/gif.latex?v0=4*a_{14}*t_{0}^{3}+3*a_{13}*t_{0}^{2}+2*a_{12}*t_{0}+a_{12}*t_{0}+a_{11})\r\n* Aceleración: ![a0 =4*3*a14t0^2 + 3*2*a13t0+ 2*a12](http://latex.codecogs.com/gif.latex?a0=4*3*a_{14}*t_{0}^{2}+3*2*a_{13}*t_{0}+2*a_{12})\r\n\r\nPunto de despegue (p1)\r\n* Posición: ![p1 = a24t1^4+ a23t1^3 + a22t1^2 + a21t1+a20](http://latex.codecogs.com/gif.latex?p1=a_{24}*t_{0}^{4}+a_{23}*t_{0}^{3}+a_{22}*t_{0}^{2}+a_{21}*t_{0}+a_{20}) \r\n* Continuidad Posición: ![a14*t1^4 + a13*t1^3+ a12*t1^2 + a11*t1 + a10 = a24* t1^4 + a23*t1^3 + a22*t12 + a21*t1 + a20](http://latex.codecogs.com/gif.latex?a_{14}*t_{1}^{4}+a_{13}*t_{1}^{3}+a_{12}*t_{1}^{2}+a_{11}*t_{1}+a_{10}=a_{24}*t_{1}^{4}+a_{23}*t_{1}^{3}+a_{22}*t_{1}^{2}+a_{21}*t_{1}+a_{20})\r\n* Continuidad Velocidad: ![4*a14*t1^3 + 3*a13*t1^2 + 2*a12*t1 + a11 = 4*a24*t1^3+ 3*a23*t1^2 + 2*a22 +a21](http://latex.codecogs.com/gif.latex?4*a_{14}*t_{1}^{3}+3*a_{13}*t_{1}^{2}+2*a_{12}*t_{1}+a_{11}=4*a_{24}*t_{1}^{3}+3*a_{23}*t_{1}^{2}+2*a_{22}+a_{21})\r\n* Continuidad Aceleración: ![12*a14*t1^2 + 6 *a13*t1+ 2*a12 =12*a24 + 6 *a23*t1+ 2*a22](http://latex.codecogs.com/gif.latex?12*a_{14}*t_{1}^{2}+6*a_{13}*t_{1}+2*a_{12}=12*a_{24}+6*a_{23}*t_{1}+2*a_{22})\r\n\r\nPunto extra (p2)\r\n> La posición debe venir determinada por la curva 2, la aceleración y la velocidad, la marca la propia curva, no el punto en cuestión. El tiempo t2, ha de ser la mitad del tiempo del segundo tramo.\r\n* Posición: p2 = a24*t2^4 + a23*t2^3 + a22*t2^2 + a21*t2 + a20 \r\n* Tiempo: t2 = (t3-t1)/2\r\n\r\nPunto de asentamiento (p3)\r\n* Posición: p3 = a34*t3^4 + a33*t3^3 + a32*t3^2 + a31*t3 + a30\r\n* Continuidad Posición: a24*t3^4 + a23*t3^3 + a22*t3^2 + a21*t3 + a20 = a34*t3^4 + a33*t3^3 + a32*t3^2 + a31*t3 + a30\r\n* Continuidad Velocidad: 4*a24*t3^3 + 3*a23*t3^2 + 2*a22*t3+ a21 = 4*a34*t3^3 + 3*a33*t3^2 + 2*a32*t3+ a31\r\n* Continuidad Aceleración:  12*a24*t3^2 + 6*a23*t3 + 2*a22 = 12*a34*t3^2 +6*a33*t3+ 2*a32\r\n\r\nPunto final (p4)\r\n* Posición: p4 = a34*t_F^4 + a33*tF_F^3 + a32*tF_F^2 + a31*t_F + a30 \r\n* Velocidad: v4 = 4*a34*t_F^3 + 3*a33*t_F^2 + 2*a32*t_F + a31\r\n* Aceleración: a4 = 12*a34*t_F^2+ 6*a33t_F+ 2*a32\r\n\r\nEn forma Matricial:\r\n![matriz](https://raw.github.com/ManMik/planif-caminos/master/img/formulas/image24.png)\r\n\r\nCon todas las ecuaciones descritas anteriormente se crea el archivo crea el programa camino.m donde se muestan las trayectorias de cada prueba que se realce. Para mayor comodidad, se introducen los datos de entrada a la función del siguiente modo:\r\n\r\n```matlab\r\nfunction practica3(p0, p1, p2, p3, p4, tt1, tt2, tt3)\r\n```\r\n> p0: punto inicial.\r\n> p1: punto despegue.\r\n> p2: punto intermedio.\r\n> p3: punto aproximación.\r\n> p4: punto final.\r\n> tt1: tiempo tramo 1.\r\n> tt2: tiempo tramo 2.\r\n> tt3: tiempo tramo 3.\r\n\r\n> Los puntos se introducen en forma de par [X,Y]\r\n\r\n---\r\n\r\n###Pruebas\r\n\r\nA continuación se muestran unas pruebas realizadas con la ejecución del programa para distintos parámetros de entrada. \r\nEn las figuras se aprecia la trayectoria del efector final del robot (colores rojo azul y amarillo) y los obstáculos (color negro). La línea verde alrededor de los objetos que representa el margen de distancia (0.8) que tiene que haber entre la trayectoria del robot y los obstáculos.\r\n\r\n####Prueba 1\r\n\r\nDatos de entrada\r\n\r\n```Matlab\r\n% Puntos \r\np0=[13,4];\r\np1=[9.5,4.3];\r\np2=[8.8,7.1];\r\np3=[7.2,10.4];\r\np4=[4,11];\r\n\r\n% tiempo para cada segmento:\r\ntt1=5;\r\ntt2=5;\r\ntt3=2;\r\n```\r\n\r\n#####Figuras\r\n\r\n![trayectoria](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image19.png)\r\n![trayectoria](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image22.png)\r\n\r\nAquí apreciamos como la velocidad del tercer tramo pasa de ser muy alta a 0 rápidamente, por lo que la aceleración, sobre todo en el sentido de las x, es muy brusca.\r\n\r\n####Prueba 2\r\n\r\nDatos de entrada\r\n\r\n```Matlab\r\n% Puntos objetivo:\r\np0=[13,4];\r\np1=[9.6,4.4];\r\np2=[8.5,8];\r\np3=[7.3,10.4];\r\np4=[4,11];\r\n\r\n% tiempo para cada segmento:\r\ntt1=7;\r\ntt2=5;\r\ntt3=2;\r\n```\t\r\n\r\n#####Figuras\r\n\r\n![trayectoria](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image20.png)\r\n![trayectoria](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image17.png)\r\n\r\nAquí el robot acelera y gana velocidad al final del segundo tramo para que haya continuidad. \r\nTambién se aprecia como en el primer tramo la velocidad y la aceleración son muy suaves.\r\n\r\n####Prueba 3\r\n\r\nDatos de entrada\r\n```Matlab\r\n% Puntos objetivo:\r\np0=[13,4];\r\np1=[8.5,4.4];\r\np2=[8.5,8];\r\np3=[7.3,11];\r\np4=[4,11];\r\n\r\n% tiempo para cada segmento:\r\ntt1=4;\r\ntt2=1;\r\ntt3=5;\r\n```\r\n#####Figuras:\r\n\r\n![trayectoria](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image18.png)\r\n![trayectoria](https://raw.github.com/ManMik/planif-caminos/master/img/graficas/image21.png)\r\n\r\nEn este ejemplo podemos apreciar como el primer y segundo tramo tienen una trazada mas suave ya que la velocidad en ambos es menor.\r\n\r\nEn las gráfica de aceleración, las dos últimas, podemos apreciar que tanto en el sentido de las x como el de las y hay una gran aceleración y luego deceleración para cumplir la continuidad con el siguiente tramo\r\n\r\nDe los movimientos anteriores, la mejor trayectoria la obtenemos con la primera prueba. La trayectoria es prácticamente paralela al camino que se forma entre los dos obstáculos. Con esta trayectoria podemos conseguir una mayor tranquilidad por el espacio que deja con los obstáculos el manipulador y dado el tiempo que le hemos dejado a este tramo (5 s) es más que una velocidad prudencial para transportar objetos entre esos obstáculos.\r\n","name":"Planif-caminos"}